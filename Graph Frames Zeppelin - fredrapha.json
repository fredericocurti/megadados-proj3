{"paragraphs":[{"text":"%pyspark\nfrom graphframes import *\nimport re","user":"anonymous","dateUpdated":"2018-11-26T19:18:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543257383029_1577476101","id":"20181121-183547_421253859","dateCreated":"2018-11-26T18:36:23+0000","dateStarted":"2018-11-26T19:18:51+0000","dateFinished":"2018-11-26T19:18:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1157"},{"text":"%pyspark\nnon_decimal = re.compile(r'[^\\d]+')\ntxt = sc.textFile(\"s3n://raphafred/links-filled.txt\")\ntitles = sc.textFile(\"s3n://raphafred/titles-sorted.txt\")\n\ntitles, txt","user":"anonymous","dateUpdated":"2018-11-26T19:18:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(s3n://raphafred/titles-sorted.txt MapPartitionsRDD[7] at textFile at NativeMethodAccessorImpl.java:0, s3n://raphafred/links-filled.txt MapPartitionsRDD[5] at textFile at NativeMethodAccessorImpl.java:0)\n"}]},"apps":[],"jobName":"paragraph_1543257383035_-370385990","id":"20181121-183601_523142357","dateCreated":"2018-11-26T18:36:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1158","dateFinished":"2018-11-26T19:18:54+0000","dateStarted":"2018-11-26T19:18:54+0000"},{"text":"%pyspark\ntitles = titles.map(lambda x: x).repartition(8)\nnodes = titles.zipWithIndex().map(lambda x: (x[1] + 1, x[0])).repartition(8)\nnodesDf = nodes.toDF(['id', 'title'])\nnodesDf.show()","user":"anonymous","dateUpdated":"2018-11-26T19:31:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+--------------------+\n| id|               title|\n+---+--------------------+\n| 21|       'Asir_Emirate|\n| 22|      'Asir_Province|\n| 23|'Asociación_de_Em...|\n| 24|                'Ata|\n| 25| 'Ata'_Bay_al-Ayyubi|\n| 26|  'Ata_Bay_al-Ayyubi|\n| 27|              'Ataba|\n| 28|              'Atara|\n| 29|            'Atbarah|\n| 30|    'Atbarah_(river)|\n|101|                  +-|\n|102|                +---|\n|103|            +-Junkie|\n|104|           +-_Junkie|\n|105|             +-ジャンキー|\n|106|                 +/-|\n|107|           +/-Junkie|\n|108|          +/-_(band)|\n|109|+/-_/_Bloodthirst...|\n|110|          +/-_Junkie|\n+---+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543257383038_1358844742","id":"20181121-191954_791331748","dateCreated":"2018-11-26T18:36:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1162","dateFinished":"2018-11-26T19:32:23+0000","dateStarted":"2018-11-26T19:31:27+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=8","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=9","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=10"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ndef edge_map(x):\n    p = non_decimal.sub(' ', x).split(' ')\n    return (p[0], p[1:])\n\nedges = txt.map(edge_map).filter(lambda x: x[1] != ['']).flatMapValues(lambda x: x)\nedgesDf = edges.toDF(['src', 'dst'])\nedgesDf.show(n=100)","user":"anonymous","dateUpdated":"2018-11-26T19:36:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-------+\n|src|    dst|\n+---+-------+\n|  1|1664968|\n|  2|      3|\n|  2| 747213|\n|  2|1664968|\n|  2|1691047|\n|  2|4095634|\n|  2|5535664|\n|  3|      9|\n|  3|  77935|\n|  3|  79583|\n|  3|  84707|\n|  3| 564578|\n|  3| 594898|\n|  3| 681805|\n|  3| 681886|\n|  3| 835470|\n|  3| 880698|\n|  3|1109091|\n|  3|1125108|\n|  3|1279972|\n|  3|1463445|\n|  3|1497566|\n|  3|1783284|\n|  3|1997564|\n|  3|2006526|\n|  3|2070954|\n|  3|2250217|\n|  3|2268713|\n|  3|2276203|\n|  3|2374802|\n|  3|2571397|\n|  3|2640902|\n|  3|2647217|\n|  3|2732378|\n|  3|2821237|\n|  3|3088028|\n|  3|3092827|\n|  3|3211549|\n|  3|3283735|\n|  3|3491412|\n|  3|3492254|\n|  3|3498305|\n|  3|3505664|\n|  3|3547201|\n|  3|3603437|\n|  3|3617913|\n|  3|3793767|\n|  3|3907547|\n|  3|4021634|\n|  3|4025897|\n|  3|4086017|\n|  3|4183126|\n|  3|4184025|\n|  3|4189168|\n|  3|4192731|\n|  3|4395141|\n|  3|4899940|\n|  3|4987592|\n|  3|4999120|\n|  3|5017477|\n|  3|5149173|\n|  3|5149311|\n|  3|5158741|\n|  3|5223097|\n|  3|5302153|\n|  3|5474252|\n|  3|5535280|\n|  4|    145|\n|  5|      8|\n|  5|  57544|\n|  5|  58089|\n|  5|  60048|\n|  5|  65880|\n|  5| 284186|\n|  5| 313376|\n|  5| 564578|\n|  5| 717529|\n|  5| 729993|\n|  5|1097284|\n|  5|1204280|\n|  5|1204407|\n|  5|1255317|\n|  5|1670218|\n|  5|1720928|\n|  5|1850305|\n|  5|2269887|\n|  5|2333350|\n|  5|2359764|\n|  5|2640693|\n|  5|2743982|\n|  5|3303009|\n|  5|3322952|\n|  5|3492254|\n|  5|3573013|\n|  5|3721693|\n|  5|3797343|\n|  5|3797349|\n|  5|3797359|\n|  5|3849461|\n|  5|4033556|\n+---+-------+\nonly showing top 100 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543257383039_-1096092002","id":"20181121-191522_787819166","dateCreated":"2018-11-26T18:36:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1163","dateFinished":"2018-11-26T19:36:07+0000","dateStarted":"2018-11-26T19:36:05+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=12","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=13"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ng = GraphFrame(nodesDf, edgesDf)","user":"anonymous","dateUpdated":"2018-11-26T19:36:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1543257383039_-1810407715","id":"20181121-201843_1739054254","dateCreated":"2018-11-26T18:36:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1164","dateFinished":"2018-11-26T19:36:15+0000","dateStarted":"2018-11-26T19:36:15+0000"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-11-26T19:21:35+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543260095561_-1462350570","id":"20181126-192135_890352205","dateCreated":"2018-11-26T19:21:35+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2458"},{"text":"%pyspark\ng.inDegrees.show()","user":"anonymous","dateUpdated":"2018-11-26T19:36:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------+\n|     id|inDegree|\n+-------+--------+\n|2640902|   10580|\n|2821237|     192|\n|5062062|      34|\n|  64985|    1074|\n|5308413|   11765|\n|4332245|      12|\n|4491104|      33|\n|2281655|     573|\n|5198037|      51|\n|2111342|      46|\n| 234737|       5|\n|3743924|      49|\n| 298403|      22|\n|    691|      47|\n|4925229|     462|\n|1324797|      28|\n|4222458|      25|\n|1019505|      63|\n|2846046|       6|\n| 206495|     322|\n+-------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1543257383040_-1225912581","id":"20181121-201903_900785556","dateCreated":"2018-11-26T18:36:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1165","dateFinished":"2018-11-26T19:51:20+0000","dateStarted":"2018-11-26T19:36:24+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=14"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\ntest = g.bfs('id=1', 'id=3')\ntest","user":"anonymous","dateUpdated":"2018-11-26T20:14:10+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543257383040_1295377584","id":"20181121-201908_2031575357","dateCreated":"2018-11-26T18:36:23+0000","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1166","dateFinished":"2018-11-26T20:13:30+0000","dateStarted":"2018-11-26T20:14:10+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=25","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=26","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=27","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=28","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=29","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=30","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=31","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=32","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=33","http://ip-172-31-71-118.ec2.internal:4040/jobs/job?id=34"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-11-26T18:36:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1543257383041_2000599044","id":"20181121-205330_788126701","dateCreated":"2018-11-26T18:36:23+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1167"}],"name":"raphfred","id":"2DYYMKHKJ","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}